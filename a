--[[ 
    Roblox Executor Script: Modern Fishing GUI
    Features:
    - Tabs: Fishing | Sell Areas | Zones | Boss Fights
    - Minimize/Maximize
    - Instant Attract/Reel buttons (no hotkeys needed, but C/R still work)
    Place anywhere (does not need StarterPlayerScripts)
--]]

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

-- ========== FISHING LOGIC ==========
local BridgeNet2 = require(ReplicatedStorage.Packages.BridgeNet2)
local Net_ForcePull = BridgeNet2.ReferenceBridge("Net_ForcePull")
local Net_ReelDelta = BridgeNet2.ReferenceBridge("Net_ReelDelta")

local MAX_REEL_PER_SECOND = 20
local TOTAL_REEL_PRESSES = 12
local INSTANT_COLLECT_FISH = 4

local function getNettingController()
    if getgc then
        for _, v in pairs(getgc(true)) do
            if type(v) == "table" and rawget(v, "UI") and rawget(v, "_tool") then
                return v
            end
        end
    end
    return nil
end

local function getState(controller)
    if controller and controller.UI then
        local StateValue = controller.UI:FindFirstChild("State")
        if StateValue then
            return StateValue.Value
        end
    end
    if controller and controller._nettingSession then
        return controller._nettingSession.State
    end
    return nil
end

local function instantCollect()
    local controller = getNettingController()
    local state = getState(controller)
    if state == "Collecting" then
        for i = 1, INSTANT_COLLECT_FISH do
            Net_ForcePull:Fire()
            wait(0.05)
        end
    end
end

local function instantReel()
    local controller = getNettingController()
    local state = getState(controller)
    if state == "Reeling" then
        for i = 1, TOTAL_REEL_PRESSES do
            Net_ReelDelta:Fire(1)
            wait(1 / MAX_REEL_PER_SECOND)
        end
    end
end

-- ========== GUI SETUP ==========
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FishingGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = game:GetService("CoreGui")

local window = Instance.new("Frame")
window.Name = "MainFrame"
window.Size = UDim2.new(0, 420, 0, 320)
window.Position = UDim2.new(0.5, -210, 0.5, -160)
window.BackgroundColor3 = Color3.fromRGB(42, 44, 51)
window.BorderSizePixel = 0
window.Parent = screenGui
window.Active = true
window.Draggable = true

local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 38)
titleBar.BackgroundColor3 = Color3.fromRGB(55, 57, 62)
titleBar.Parent = window

local title = Instance.new("TextLabel")
title.Text = "Fishing & Teleport GUI"
title.Font = Enum.Font.GothamBold
title.TextSize = 19
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.Size = UDim2.new(1, -80, 1, 0)
title.Position = UDim2.new(0, 12, 0, 0)
title.Parent = titleBar

local minBtn = Instance.new("TextButton")
minBtn.Text = "_"
minBtn.Size = UDim2.new(0, 38, 1, 0)
minBtn.Position = UDim2.new(1, -76, 0, 0)
minBtn.Font = Enum.Font.GothamBold
minBtn.TextSize = 28
minBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
minBtn.TextColor3 = Color3.new(1,1,1)
minBtn.Parent = titleBar

local maxBtn = Instance.new("TextButton")
maxBtn.Text = "â¬œ"
maxBtn.Size = UDim2.new(0, 38, 1, 0)
maxBtn.Position = UDim2.new(1, -38, 0, 0)
maxBtn.Font = Enum.Font.GothamBold
maxBtn.TextSize = 22
maxBtn.BackgroundColor3 = Color3.fromRGB(80,80,80)
maxBtn.TextColor3 = Color3.new(1,1,1)
maxBtn.Parent = titleBar

local minimized = false

minBtn.MouseButton1Click:Connect(function()
    minimized = true
    for _, tab in ipairs(window:GetChildren()) do
        if tab:IsA("Frame") and tab ~= titleBar then
            tab.Visible = false
        end
    end
    window.Size = UDim2.new(0,420,0,38)
end)
maxBtn.MouseButton1Click:Connect(function()
    minimized = false
    window.Size = UDim2.new(0,420,0,320)
    for i, tab in ipairs(window:GetChildren()) do
        if tab:IsA("Frame") and tab ~= titleBar then
            tab.Visible = false
        end
    end
    if window:FindFirstChild("FishingTab") then
        window.FishingTab.Visible = true
    end
end)

-- Tabs & Buttons
local tabBtnHolder = Instance.new("Frame")
tabBtnHolder.Size = UDim2.new(1, 0, 0, 38)
tabBtnHolder.Position = UDim2.new(0,0,0,38)
tabBtnHolder.BackgroundTransparency = 1
tabBtnHolder.Parent = window

local tabNames = {"Fishing", "Sell Teleport", "Zone Teleport", "Boss Teleport"}
local tabs = {}
local tabBtns = {}
for i, tabName in ipairs(tabNames) do
    local btn = Instance.new("TextButton")
    btn.Text = tabName
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 16
    btn.Size = UDim2.new(0, 105, 1, 0)
    btn.Position = UDim2.new(0, (i-1)*105, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(65,65,65)
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Parent = tabBtnHolder
    tabBtns[i] = btn

    local tab = Instance.new("Frame")
    tab.Name = tabName:gsub(" ", "").."Tab"
    tab.BackgroundTransparency = 1
    tab.Size = UDim2.new(1, 0, 1, -76)
    tab.Position = UDim2.new(0, 0, 0, 76)
    tab.Visible = (i == 1)
    tab.Parent = window
    tabs[i] = tab
end

-- Fishing Tab
do
    local tab = tabs[1]
    local attractBtn = Instance.new("TextButton")
    attractBtn.Text = "Instant Attract Fish"
    attractBtn.Font = Enum.Font.GothamBold
    attractBtn.TextSize = 16
    attractBtn.Size = UDim2.new(0, 370, 0, 40)
    attractBtn.Position = UDim2.new(0, 25, 0, 35)
    attractBtn.BackgroundColor3 = Color3.fromRGB(60, 180, 90)
    attractBtn.TextColor3 = Color3.new(1,1,1)
    attractBtn.Parent = tab
    attractBtn.MouseButton1Click:Connect(function()
        instantCollect()
    end)

    local reelBtn = Instance.new("TextButton")
    reelBtn.Text = "Instant Reel"
    reelBtn.Font = Enum.Font.GothamBold
    reelBtn.TextSize = 16
    reelBtn.Size = UDim2.new(0, 370, 0, 40)
    reelBtn.Position = UDim2.new(0, 25, 0, 85)
    reelBtn.BackgroundColor3 = Color3.fromRGB(60, 130, 250)
    reelBtn.TextColor3 = Color3.new(1,1,1)
    reelBtn.Parent = tab
    reelBtn.MouseButton1Click:Connect(function()
        instantReel()
    end)

    local info = Instance.new("TextLabel")
    info.Text = "Press the buttons above to instantly attract fish or reel in.\n(C and R hotkeys still work)"
    info.Font = Enum.Font.Gotham
    info.TextSize = 14
    info.Size = UDim2.new(1, -20, 0, 40)
    info.Position = UDim2.new(0, 10, 0, 135)
    info.TextColor3 = Color3.new(1,1,1)
    info.BackgroundTransparency = 1
    info.Parent = tab
end

-- Sell Teleport Tab
do
    local tab = tabs[2]
    local src = workspace:FindFirstChild("GameStalls")
    if src then
        local y = 10
        for _, obj in pairs(src:GetChildren()) do
            if obj:IsA("BasePart") or obj:IsA("Model") then
                local btn = Instance.new("TextButton")
                btn.Size = UDim2.new(0, 370, 0, 35)
                btn.Position = UDim2.new(0, 25, 0, y)
                btn.Text = "Teleport to "..obj.Name
                btn.BackgroundColor3 = Color3.fromRGB(120,90,90)
                btn.TextColor3 = Color3.new(1,1,1)
                btn.Font = Enum.Font.Gotham
                btn.TextSize = 16
                btn.Parent = tab
                y = y + 40
                btn.MouseButton1Click:Connect(function()
                    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                    if obj:IsA("BasePart") then
                        char:MoveTo(obj.Position)
                    elseif obj:IsA("Model") and obj.PrimaryPart then
                        char:MoveTo(obj.PrimaryPart.Position)
                    else
                        local part = obj:FindFirstChildWhichIsA("BasePart")
                        if part then
                            char:MoveTo(part.Position)
                        end
                    end
                end)
            end
        end
    else
        local txt = Instance.new("TextLabel")
        txt.Text = "No GameStalls found!"
        txt.Size = UDim2.new(1,0,0,40)
        txt.Position = UDim2.new(0,0,0,10)
        txt.Font = Enum.Font.Gotham
        txt.TextColor3 = Color3.fromRGB(200,50,50)
        txt.BackgroundTransparency = 1
        txt.Parent = tab
    end
end

-- Zone Teleport Tab
do
    local tab = tabs[3]
    local src = workspace:FindFirstChild("Zones")
    if src then
        local y = 10
        for _, obj in pairs(src:GetChildren()) do
            if obj:IsA("BasePart") or obj:IsA("Model") then
                local btn = Instance.new("TextButton")
                btn.Size = UDim2.new(0, 370, 0, 35)
                btn.Position = UDim2.new(0, 25, 0, y)
                btn.Text = "Teleport to "..obj.Name
                btn.BackgroundColor3 = Color3.fromRGB(90,120,90)
                btn.TextColor3 = Color3.new(1,1,1)
                btn.Font = Enum.Font.Gotham
                btn.TextSize = 16
                btn.Parent = tab
                y = y + 40
                btn.MouseButton1Click:Connect(function()
                    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                    if obj:IsA("BasePart") then
                        char:MoveTo(obj.Position)
                    elseif obj:IsA("Model") and obj.PrimaryPart then
                        char:MoveTo(obj.PrimaryPart.Position)
                    else
                        local part = obj:FindFirstChildWhichIsA("BasePart")
                        if part then
                            char:MoveTo(part.Position)
                        end
                    end
                end)
            end
        end
    else
        local txt = Instance.new("TextLabel")
        txt.Text = "No Zones found!"
        txt.Size = UDim2.new(1,0,0,40)
        txt.Position = UDim2.new(0,0,0,10)
        txt.Font = Enum.Font.Gotham
        txt.TextColor3 = Color3.fromRGB(200,50,50)
        txt.BackgroundTransparency = 1
        txt.Parent = tab
    end
end

-- Boss Teleport Tab
do
    local tab = tabs[4]
    local BossEvent = ReplicatedStorage:FindFirstChild("Assets") and ReplicatedStorage.Assets:FindFirstChild("BossEvent")
    if BossEvent then
        local y = 10
        for _, obj in pairs(BossEvent:GetChildren()) do
            if obj:IsA("BasePart") or obj:IsA("Model") then
                local btn = Instance.new("TextButton")
                btn.Size = UDim2.new(0, 370, 0, 35)
                btn.Position = UDim2.new(0, 25, 0, y)
                btn.Text = "Teleport to "..obj.Name
                btn.BackgroundColor3 = Color3.fromRGB(90,90,120)
                btn.TextColor3 = Color3.new(1,1,1)
                btn.Font = Enum.Font.Gotham
                btn.TextSize = 16
                btn.Parent = tab
                y = y + 40
                btn.MouseButton1Click:Connect(function()
                    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                    if obj:IsA("BasePart") then
                        char:MoveTo(obj.Position)
                    elseif obj:IsA("Model") and obj.PrimaryPart then
                        char:MoveTo(obj.PrimaryPart.Position)
                    else
                        local part = obj:FindFirstChildWhichIsA("BasePart")
                        if part then
                            char:MoveTo(part.Position)
                        end
                    end
                end)
            end
        end
    else
        local txt = Instance.new("TextLabel")
        txt.Text = "No BossEvent found!"
        txt.Size = UDim2.new(1,0,0,40)
        txt.Position = UDim2.new(0,0,0,10)
        txt.Font = Enum.Font.Gotham
        txt.TextColor3 = Color3.fromRGB(200,50,50)
        txt.BackgroundTransparency = 1
        txt.Parent = tab
    end
end

-- Tab switching
local function showTab(idx)
    if minimized then return end
    for i, tab in ipairs(tabs) do
        tab.Visible = (i == idx)
    end
end
for i, btn in ipairs(tabBtns) do
    btn.MouseButton1Click:Connect(function()
        showTab(i)
    end)
end
showTab(1)

-- Optional: keep old hotkey support
game:GetService("UserInputService").InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.C then
        instantCollect()
    elseif input.KeyCode == Enum.KeyCode.R then
        instantReel()
    end
end)
